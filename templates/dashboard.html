{% extends "base.html" %}
{% block content %}
<h2>Dashboard</h2>
<div>
    <img src="{{ url_for('static', filename='pet_images/' + pet_image) }}" width="120" alt="pet emoji">
    <div>Your pet is feeling: <span style="font-size:2em">{{ emotion }}</span></div>
</div>
<div>
    <p>Budget: ${{ budget }}</p>
    <p>Total Expense: ${{ total_expense }}</p>
    <p>Net: ${{ net }}</p>
    <form method="POST" action="{{ url_for('add_transaction') }}">
        <input name="amount" type="number" step="0.01" placeholder="Amount" required>
        <input name="category" placeholder="Category" required>
        <select name="type">
            <option value="expense">Expense</option>
            <option value="income">Income</option>
        </select>
        <button type="submit">Add</button>
    </form>
    <form method="POST" enctype="multipart/form-data" action="{{ url_for('upload_receipt') }}">
        <input type="file" name="receipt" accept="image/*" required>
        <button type="submit">Upload Receipt</button>
    </form>
    {% if extracted_amount and extracted_amount != "None" %}
        <div style="margin-top:1em">
            <strong>Detected amount from receipt: ${{ extracted_amount }}</strong>
            <script>
            document.querySelector('input[name="amount"]').value = "{{ extracted_amount }}";
            </script>
        </div>
    {% endif %}
</div>
<div>
    <h3>Transactions</h3>
    <ul>
    {% for t in transactions %}
        <li>${{ t.amount }} ({{ t.category }}) [{{ t.type }}] - {{ t.date.strftime('%Y-%m-%d') }}</li>
    {% endfor %}
    </ul>
</div>
<a href="{{ url_for('logout') }}">Logout</a>
{% endblock %}
