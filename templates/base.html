<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Budget Guardian</title>
    <meta name="theme-color" content="#0b1020">
    <link rel="manifest" href="{{ url_for('manifest') }}">
    <link rel="icon" href="{{ url_for('static', filename='icon.svg') }}" type="image/svg+xml">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}?v=3">
    <!-- Fallback: ensures readable dark mode even if CSS is blocked/cached -->
    <style>
      body { background: #0b1020; color: rgba(255,255,255,0.92); }
    </style>
</head>
<body>
    <header class="nav">
        <div class="nav__inner">
            <a class="nav__brand" href="{{ url_for('index') }}">Budget Guardian</a>
            <nav class="nav__links">
                {% if current_user.is_authenticated %}
                    <a class="nav__link" href="{{ url_for('dashboard') }}">Dashboard</a>
                    <a class="nav__link nav__link--danger" href="{{ url_for('logout') }}">Logout</a>
                {% else %}
                    <a class="nav__link" href="{{ url_for('login') }}">Login</a>
                    <a class="nav__link nav__link--primary" href="{{ url_for('register') }}">Register</a>
                {% endif %}
            </nav>
        </div>
    </header>

    <main class="container">
        {% block content %}{% endblock %}
    </main>

    <script>
    // Register service worker for PWA installability (best-effort).
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('{{ url_for('service_worker') }}').catch(() => {});
      });
    }
    </script>
</body>
</html>
